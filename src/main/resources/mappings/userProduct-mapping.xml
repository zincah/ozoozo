<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="UserProduct">

	<!-- 상품 상세 페이지 가져오기 -->
	<select id="product_get" resultType="userproduct">
		SELECT DISTINCT ON(option1) po.option1,c.cate_name,sc.subcate_name, s.company_name,pp.post_name, pp.sale_ratio, pp.whole_price, p.product_id, po.option1_name, po.option2_name from product_posting pp
	inner join product p on pp.post_id = p.product_postid 
	inner join product_option po on p.product_id = po.op_productid
	inner join seller s on s.seller_id = pp.post_sellerid 
	inner join category c ON c.cate_code = po_category 
	inner join sub_category sc ON sc.subcate_code = pp.po_subcate 
	where pp.post_id = 50003; <!-- 여기다가 id 값 넣어주면 됨 -->
	</select>
	<!-- 2번 옵션 겁색 셀렉트	 -->
	<select id="product_option2_get" resultType="userproduct">
		SELECT  s.company_name,ps.post_name, ps.sale_ratio, ps.whole_price, p.product_id, po.option1_name , po.option1, po.option2_name , po.option2  FROM seller s 
			INNER JOIN product_posting ps ON ps.post_sellerid = s.seller_id 
			INNER JOIN product p ON p.product_postid =  ps.post_id 
			INNER JOIN product_option po ON p.product_id = po.op_productid	
			WHERE po.option1 = #{option1} AND post_id=50003;
	</select>
	
	<select id="product_Get_img" resultType="userproduct">
	select pi2.photo_url, pi2.photo_separate  from product_posting pp 
		inner join product_image pi2 on pi2.photo_postid = pp.post_id 
		where pp.post_id = 50003 order by pi2.photo_id asc;
	
	</select>
	
	<select id="product_Get_table" resultType="user_P_table">
	select * from product_tables 
	where protable_postid = 50003;
	</select>
	
	<select id="basket_info" resultType="cart">
		select cart_product, cart_post, cart_quantity from cart c 
	where cart_user = #{user_num};
	</select>
	
	<select id="product_Get_id" resultType="cart">
	SELECT p.product_id,p.seller_id,p.product_price FROM product p 
		inner join product_option po on p.product_id = po.op_productid 
		where po.option1 = #{option1} and po.option2 = #{option2} and p.product_postid = 50003
	</select>
	
	<insert id="cart_add" >
	insert into cart(cart_user,cart_post,cart_product,  cart_quantity,  cart_payment, cart_seller) 
		values (#{cart_user},50003, #{product_id}, #{EA}, #{cart_payment}, #{seller_id} );
	</insert>
	
	<update id="cart_update">
	update cart set cart_quantity= #{cart_quantity}, cart_payment = #{cart_payment}
		where cart_product = #{cart_product}
	</update>
	
	
</mapper>