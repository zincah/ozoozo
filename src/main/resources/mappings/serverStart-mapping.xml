<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="ServerStart">
	
	<!-- 배송중 시간에 따른 배송완료 처리 -->
	<update id="shippingUpdate">
		UPDATE user_order uo SET order_status = '배송완료', shipfinish_date = now() 
		WHERE (EXTRACT(EPOCH FROM NOW() - uo.shipstart_date))::Integer > 60 and uo.shipfinish_date = null;
	</update>

	<!-- 오늘의딜 자동 마감 처리 -->
	<update id="postingDealUpdate">
		UPDATE user_order uo SET order_status = '배송완료', shipfinish_date = now() 
		WHERE (EXTRACT(EPOCH FROM NOW() - uo.shipstart_date))::Integer > 60 and uo.shipfinish_date = null;
	</update>
</mapper>

